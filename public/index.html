<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SyncToken - Premium NFC Tokens</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
      background: #f5f5f7;
      color: #1d1d1f;
      line-height: 1.5;
    }

    .header {
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      position: sticky;
      top: 0;
      z-index: 100;
      padding: 20px 0;
    }

    .container {
      max-width: 980px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .hero {
      text-align: center;
      padding: 60px 0 40px;
    }

    .hero h1 {
      font-size: 48px;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .hero p {
      font-size: 21px;
      color: #86868b;
    }

    .selection-section {
      background: white;
      border-radius: 18px;
      padding: 40px;
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.04);
    }

    .token-type-selector {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      margin-bottom: 40px;
    }

    .type-option {
      border: 2px solid #d2d2d7;
      border-radius: 12px;
      padding: 24px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }

    .type-option:hover {
      border-color: #0071e3;
      transform: scale(1.02);
    }

    .type-option.selected {
      border-color: #0071e3;
      background: #f0f8ff;
    }

    .type-option h3 {
      font-size: 20px;
      margin-bottom: 8px;
    }

    .type-option p {
      color: #86868b;
      font-size: 14px;
    }

    .design-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 16px;
      margin-bottom: 40px;
    }

    .design-option {
      border: 2px solid #d2d2d7;
      border-radius: 12px;
      padding: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      background: #fafafa;
    }

    .design-option:hover {
      border-color: #0071e3;
      transform: translateY(-2px);
    }

    .design-option.selected {
      border-color: #0071e3;
      background: white;
      box-shadow: 0 4px 12px rgba(0, 113, 227, 0.15);
    }

    .design-option img {
      width: 80px;
      height: 80px;
      margin-bottom: 8px;
    }

    .form-group {
      margin-bottom: 32px;
    }

    .form-group label {
      display: block;
      font-size: 17px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .form-group input[type="text"],
    .form-group input[type="number"],
    .form-group input[type="url"],
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 16px;
      border: 1px solid #d2d2d7;
      border-radius: 10px;
      font-size: 17px;
      transition: border-color 0.3s ease;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: #0071e3;
    }

    .checkbox-group {
      display: flex;
      align-items: center;
      padding: 16px;
      border: 1px solid #d2d2d7;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .checkbox-group:hover {
      border-color: #0071e3;
    }

    .checkbox-group.checked {
      background: #f0f8ff;
      border-color: #0071e3;
    }

    .checkbox-group input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-right: 12px;
    }

    .file-upload {
      position: relative;
      display: inline-block;
      cursor: pointer;
      width: 100%;
    }

    .file-upload input[type="file"] {
      position: absolute;
      opacity: 0;
      width: 100%;
      height: 100%;
    }

    .file-upload-label {
      display: block;
      padding: 16px;
      border: 2px dashed #d2d2d7;
      border-radius: 10px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .file-upload:hover .file-upload-label {
      border-color: #0071e3;
      background: #f0f8ff;
    }

    .customizer-section {
      background: #f5f5f7;
      border-radius: 12px;
      padding: 24px;
      margin: 32px 0;
    }

    .color-controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-bottom: 32px;
    }

    .color-control {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px;
      border: 1px solid #d2d2d7;
      border-radius: 10px;
    }

    .color-control input[type="color"] {
      width: 50px;
      height: 50px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    #viewer {
      width: 100%;
      height: 400px;
      border-radius: 12px;
      overflow: hidden;
      background: #f5f5f7;
    }

    .price-summary {
      background: #f5f5f7;
      border-radius: 12px;
      padding: 24px;
      margin: 32px 0;
    }

    .price-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 12px;
      font-size: 17px;
    }

    .price-row.total {
      font-size: 24px;
      font-weight: 600;
      padding-top: 12px;
      border-top: 1px solid #d2d2d7;
    }

    .order-button {
      width: 100%;
      padding: 18px 32px;
      background: #0071e3;
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 17px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .order-button:hover {
      background: #0051d5;
      transform: translateY(-1px);
    }

    .hidden {
      display: none;
    }

    .section-title {
      font-size: 28px;
      font-weight: 600;
      margin-bottom: 24px;
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="container">
      <h2 style="font-size: 24px; font-weight: 600;">SyncToken</h2>
    </div>
  </header>

  <main>
    <div class="hero">
      <div class="container">
        <h1>Order Your SyncToken</h1>
        <p>Premium NFC-enabled tokens, crafted to perfection</p>
      </div>
    </div>

    <div class="container">
      <form id="orderForm">
        <div class="selection-section">
          <h2 class="section-title">Choose Your Token Type</h2>
          
          <div class="token-type-selector">
            <div class="type-option" data-type="premade">
              <h3>Premade Designs</h3>
              <p>Choose from our curated collection</p>
              <p style="font-size: 16px; margin-top: 8px; color: #1d1d1f;">Starting at $10</p>
            </div>
            <div class="type-option" data-type="custom">
              <h3>Custom Design</h3>
              <p>Create your unique token</p>
              <p style="font-size: 16px; margin-top: 8px; color: #1d1d1f;">$500 base + unit price</p>
            </div>
          </div>

          <div id="premadeSection" class="hidden">
            <h3 style="margin-bottom: 24px;">Select a Design</h3>
            <div class="design-grid">
              <div class="design-option" data-design="wine">
                <img src="https://via.placeholder.com/80?text=Wine" alt="Wine Glass">
                <div>Wine Glass</div>
              </div>
              <div class="design-option" data-design="heel">
                <img src="https://via.placeholder.com/80?text=Heel" alt="High Heel">
                <div>High Heel</div>
              </div>
              <div class="design-option" data-design="tire">
                <img src="https://via.placeholder.com/80?text=Tire" alt="Tire">
                <div>Tire</div>
              </div>
              <div class="design-option" data-design="star">
                <img src="https://via.placeholder.com/80?text=Star" alt="Star">
                <div>Star</div>
              </div>
              <div class="design-option" data-design="crown">
                <img src="https://via.placeholder.com/80?text=Crown" alt="Crown">
                <div>Crown</div>
              </div>
              <div class="design-option" data-design="hammer">
                <img src="https://via.placeholder.com/80?text=Hammer" alt="Hammer">
                <div>Hammer</div>
              </div>
              <div class="design-option" data-design="mic">
                <img src="https://via.placeholder.com/80?text=Mic" alt="Microphone">
                <div>Microphone</div>
              </div>
              <div class="design-option" data-design="book">
                <img src="https://via.placeholder.com/80?text=Book" alt="Book">
                <div>Book</div>
              </div>
              <div class="design-option" data-design="leaf">
                <img src="https://via.placeholder.com/80?text=Leaf" alt="Leaf">
                <div>Leaf</div>
              </div>
              <div class="design-option" data-design="house">
                <img src="https://via.placeholder.com/80?text=House" alt="House">
                <div>House</div>
              </div>
            </div>

            <div class="form-group">
              <div class="checkbox-group" id="customTextOption">
                <input type="checkbox" id="addCustomText" name="addCustomText">
                <label for="addCustomText" style="margin: 0;">Add Instagram Handle or Custom Name (+$50)</label>
              </div>
              <input type="text" id="customText" name="customText" placeholder="@username or custom text" class="hidden" style="margin-top: 16px;">
            </div>
          </div>

          <div id="customSection" class="hidden">
            <div class="form-group">
              <label>Describe Your Custom Design</label>
              <textarea name="customDescription" rows="4" placeholder="Please describe your custom token design in detail..."></textarea>
            </div>

            <div class="form-group">
              <label>Upload Reference Image (Optional)</label>
              <div class="file-upload">
                <input type="file" id="customFile" name="customFile" accept="image/*">
                <label for="customFile" class="file-upload-label">
                  <span>Click to upload or drag and drop</span>
                </label>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label>Quantity</label>
            <input type="number" id="quantity" name="quantity" value="1" min="1">
          </div>

          <div class="form-group">
            <label>NFC Link URL</label>
            <input type="url" id="nfcUrl" name="nfcUrl" placeholder="https://example.com">
          </div>

          <div class="customizer-section hidden" id="customizerSection">
            <h3 style="margin-bottom: 24px;">Customize Your Token</h3>
            
            <div id="viewer"></div>
            
            <div class="color-controls">
              <div class="color-control">
                <label>Bottom Layer</label>
                <input type="color" id="colorBottom" value="#c0c0c0">
              </div>
              <div class="color-control">
                <label>Middle Layer</label>
                <input type="color" id="colorMiddle" value="#a0a0a0">
              </div>
              <div class="color-control">
                <label>Top Layer</label>
                <input type="color" id="colorTop" value="#808080">
              </div>
            </div>
          </div>

          <div class="price-summary">
            <div class="price-row" id="basePrice" style="display: none;">
              <span>Base Fee</span>
              <span>$500</span>
            </div>
            <div class="price-row" id="unitPrice">
              <span>Unit Price</span>
              <span>$10</span>
            </div>
            <div class="price-row" id="quantityRow">
              <span>Quantity</span>
              <span>1</span>
            </div>
            <div class="price-row" id="customTextPrice" style="display: none;">
              <span>Custom Text</span>
              <span>$50</span>
            </div>
            <div class="price-row total">
              <span>Total</span>
              <span id="totalPrice">$10</span>
            </div>
          </div>

          <button type="submit" class="order-button">Place Order</button>
        </div>
      </form>


    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/examples/js/loaders/STLLoader.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/examples/js/controls/OrbitControls.js"></script>
  <script>
    // Pricing structure
    const pricing = {
      premade: [
        { max: 9, price: 10 },
        { max: 49, price: 8 },
        { max: 99, price: 7 },
        { max: Infinity, price: 5 }
      ],
      custom: [
        { max: 9, price: 9 },
        { max: 49, price: 7 },
        { max: 99, price: 6 },
        { max: Infinity, price: 4 }
      ]
    };

    // State
    let state = {
      type: null,
      design: null,
      quantity: 1,
      customText: false,
      baseFee: 0
    };

    // DOM elements
    const typeOptions = document.querySelectorAll('.type-option');
    const premadeSection = document.getElementById('premadeSection');
    const customSection = document.getElementById('customSection');
    const customizerSection = document.getElementById('customizerSection');
    const designOptions = document.querySelectorAll('.design-option');
    const quantityInput = document.getElementById('quantity');
    const customTextCheckbox = document.getElementById('addCustomText');
    const customTextInput = document.getElementById('customText');
    const customTextOption = document.getElementById('customTextOption');
    const fileInput = document.getElementById('customFile');
    const fileLabel = document.querySelector('.file-upload-label span');

    // Event listeners
    typeOptions.forEach(option => {
      option.addEventListener('click', () => {
        typeOptions.forEach(opt => opt.classList.remove('selected'));
        option.classList.add('selected');
        
        state.type = option.dataset.type;
        state.baseFee = state.type === 'custom' ? 500 : 0;
        
        if (state.type === 'premade') {
          premadeSection.classList.remove('hidden');
          customSection.classList.add('hidden');
        } else {
          premadeSection.classList.add('hidden');
          customSection.classList.remove('hidden');
          customizerSection.classList.add('hidden');
        }
        
        updatePrice();
      });
    });

    designOptions.forEach(option => {
      option.addEventListener('click', () => {
        designOptions.forEach(opt => opt.classList.remove('selected'));
        option.classList.add('selected');
        state.design = option.dataset.design;
        
        // Show customizer for selected design
        customizerSection.classList.remove('hidden');
        // Initialize 3D viewer
        init3DViewer();
      });
    });

    quantityInput.addEventListener('input', (e) => {
      state.quantity = parseInt(e.target.value) || 1;
      updatePrice();
    });

    customTextOption.addEventListener('click', () => {
      state.customText = !state.customText;
      customTextCheckbox.checked = state.customText;
      customTextOption.classList.toggle('checked', state.customText);
      customTextInput.classList.toggle('hidden', !state.customText);
      updatePrice();
    });

    fileInput.addEventListener('change', (e) => {
      if (e.target.files.length > 0) {
        fileLabel.textContent = e.target.files[0].name;
      }
    });

    function getUnitPrice() {
      if (!state.type) return 0;
      
      const priceList = pricing[state.type];
      for (let tier of priceList) {
        if (state.quantity <= tier.max) {
          return tier.price;
        }
      }
    }

    function updatePrice() {
      const unitPrice = getUnitPrice();
      const customTextFee = state.customText ? 50 : 0;
      const total = state.baseFee + (unitPrice * state.quantity) + customTextFee;
      
      // Update price display
      document.getElementById('basePrice').style.display = state.baseFee > 0 ? 'flex' : 'none';
      document.getElementById('unitPrice').querySelector('span:last-child').textContent = `${unitPrice}`;
      document.getElementById('quantityRow').querySelector('span:last-child').textContent = state.quantity;
      document.getElementById('customTextPrice').style.display = state.customText ? 'flex' : 'none';
      document.getElementById('totalPrice').textContent = `${total}`;
    }

    // 3D Viewer
    let viewer3D = {
      scene: null,
      camera: null,
      renderer: null,
      controls: null,
      layers: {
        bottom: { mesh: null, material: null },
        middle: { mesh: null, material: null },
        top: { mesh: null, material: null }
      }
    };

    function init3DViewer() {
      const container = document.getElementById('viewer');
      
      // Clear previous viewer
      if (viewer3D.renderer) {
        viewer3D.renderer.dispose();
        container.innerHTML = '';
      }

      // Create scene
      viewer3D.scene = new THREE.Scene();
      viewer3D.scene.background = new THREE.Color(0xf5f5f7);

      // Create camera
      viewer3D.camera = new THREE.PerspectiveCamera(
        50,
        container.clientWidth / container.clientHeight,
        0.1,
        1000
      );
      viewer3D.camera.position.set(50, 50, 50);

      // Create renderer
      viewer3D.renderer = new THREE.WebGLRenderer({ antialias: true });
      viewer3D.renderer.setSize(container.clientWidth, container.clientHeight);
      viewer3D.renderer.shadowMap.enabled = true;
      viewer3D.renderer.shadowMap.type = THREE.PCFSoftShadowMap;
      container.appendChild(viewer3D.renderer.domElement);

      // Add lights
      const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
      viewer3D.scene.add(ambientLight);

      const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
      directionalLight.position.set(10, 10, 5);
      directionalLight.castShadow = true;
      viewer3D.scene.add(directionalLight);

      // Add controls
      viewer3D.controls = new THREE.OrbitControls(viewer3D.camera, viewer3D.renderer.domElement);
      viewer3D.controls.enableDamping = true;
      viewer3D.controls.dampingFactor = 0.05;
      viewer3D.controls.enablePan = false;
      viewer3D.controls.minDistance = 30;
      viewer3D.controls.maxDistance = 100;

      // Create materials for each layer
      viewer3D.layers.bottom.material = new THREE.MeshPhongMaterial({
        color: 0xc0c0c0,
        specular: 0x222222,
        shininess: 100
      });
      
      viewer3D.layers.middle.material = new THREE.MeshPhongMaterial({
        color: 0xa0a0a0,
        specular: 0x222222,
        shininess: 100
      });
      
      viewer3D.layers.top.material = new THREE.MeshPhongMaterial({
        color: 0x808080,
        specular: 0x222222,
        shininess: 100
      });

      // Create placeholder geometry
      createPlaceholderToken();

      // Try to load STL files
      loadTokenSTLs();

      // Start animation
      animate3D();

      // Setup color controls
      setupColorControls();
    }

    function createPlaceholderToken() {
      // Create simple cylinder placeholders for each layer
      const radius = 15;
      const height = 3;
      const segments = 32;

      // Bottom layer
      const bottomGeometry = new THREE.CylinderGeometry(radius, radius, height, segments);
      viewer3D.layers.bottom.mesh = new THREE.Mesh(bottomGeometry, viewer3D.layers.bottom.material);
      viewer3D.layers.bottom.mesh.position.y = -height - 1;
      viewer3D.layers.bottom.mesh.castShadow = true;
      viewer3D.layers.bottom.mesh.receiveShadow = true;
      viewer3D.scene.add(viewer3D.layers.bottom.mesh);

      // Middle layer
      const middleGeometry = new THREE.CylinderGeometry(radius * 0.9, radius * 0.9, height, segments);
      viewer3D.layers.middle.mesh = new THREE.Mesh(middleGeometry, viewer3D.layers.middle.material);
      viewer3D.layers.middle.mesh.position.y = 0;
      viewer3D.layers.middle.mesh.castShadow = true;
      viewer3D.layers.middle.mesh.receiveShadow = true;
      viewer3D.scene.add(viewer3D.layers.middle.mesh);

      // Top layer
      const topGeometry = new THREE.CylinderGeometry(radius * 0.8, radius * 0.8, height, segments);
      viewer3D.layers.top.mesh = new THREE.Mesh(topGeometry, viewer3D.layers.top.material);
      viewer3D.layers.top.mesh.position.y = height + 1;
      viewer3D.layers.top.mesh.castShadow = true;
      viewer3D.layers.top.mesh.receiveShadow = true;
      viewer3D.scene.add(viewer3D.layers.top.mesh);
    }

    function loadTokenSTLs() {
      const loader = new THREE.STLLoader();
      const design = state.design || 'wine';
      
      // Load each layer
      ['bottom', 'middle', 'top'].forEach((layer, index) => {
        const filename = `${design}-${layer}.stl`;
        
        loader.load(
          filename,
          (geometry) => {
            // Success: Replace placeholder with STL
            geometry.computeVertexNormals();
            geometry.center();
            
            // Remove placeholder
            if (viewer3D.layers[layer].mesh) {
              viewer3D.scene.remove(viewer3D.layers[layer].mesh);
            }
            
            // Create new mesh with STL geometry
            viewer3D.layers[layer].mesh = new THREE.Mesh(geometry, viewer3D.layers[layer].material);
            viewer3D.layers[layer].mesh.position.y = (index - 1) * 8; // Stack layers
            viewer3D.layers[layer].mesh.castShadow = true;
            viewer3D.layers[layer].mesh.receiveShadow = true;
            viewer3D.scene.add(viewer3D.layers[layer].mesh);
            
            // Auto-center camera on first successful load
            if (index === 0) {
              const box = new THREE.Box3().setFromObject(viewer3D.layers[layer].mesh);
              const center = box.getCenter(new THREE.Vector3());
              viewer3D.controls.target.copy(center);
            }
          },
          (xhr) => {
            // Progress
            console.log(`${layer}: ${(xhr.loaded / xhr.total * 100)}% loaded`);
          },
          (error) => {
            // Error: Keep placeholder
            console.log(`Could not load ${filename}, using placeholder`);
          }
        );
      });
    }

    function setupColorControls() {
      document.getElementById('colorBottom').addEventListener('input', (e) => {
        if (viewer3D.layers.bottom.material) {
          viewer3D.layers.bottom.material.color.set(e.target.value);
        }
      });
      
      document.getElementById('colorMiddle').addEventListener('input', (e) => {
        if (viewer3D.layers.middle.material) {
          viewer3D.layers.middle.material.color.set(e.target.value);
        }
      });
      
      document.getElementById('colorTop').addEventListener('input', (e) => {
        if (viewer3D.layers.top.material) {
          viewer3D.layers.top.material.color.set(e.target.value);
        }
      });
    }

    function animate3D() {
      if (!viewer3D.renderer) return;
      
      requestAnimationFrame(animate3D);
      
      // Rotate the token slowly
      if (viewer3D.layers.bottom.mesh) viewer3D.layers.bottom.mesh.rotation.y += 0.005;
      if (viewer3D.layers.middle.mesh) viewer3D.layers.middle.mesh.rotation.y += 0.005;
      if (viewer3D.layers.top.mesh) viewer3D.layers.top.mesh.rotation.y += 0.005;
      
      viewer3D.controls.update();
      viewer3D.renderer.render(viewer3D.scene, viewer3D.camera);
    }

    // Handle window resize
    window.addEventListener('resize', () => {
      if (viewer3D.camera && viewer3D.renderer) {
        const container = document.getElementById('viewer');
        viewer3D.camera.aspect = container.clientWidth / container.clientHeight;
        viewer3D.camera.updateProjectionMatrix();
        viewer3D.renderer.setSize(container.clientWidth, container.clientHeight);
      }
    });

    // Form submission
    document.getElementById('orderForm').addEventListener('submit', (e) => {
      e.preventDefault();
      
      // Collect form data
      const formData = {
        type: state.type,
        design: state.design,
        quantity: state.quantity,
        customText: state.customText ? customTextInput.value : null,
        nfcUrl: document.getElementById('nfcUrl').value,
        totalPrice: document.getElementById('totalPrice').textContent,
        colors: {
          bottom: document.getElementById('colorBottom').value,
          middle: document.getElementById('colorMiddle').value,
          top: document.getElementById('colorTop').value
        }
      };
      
      console.log('Order submitted:', formData);
      alert('Order form is ready! Form data logged to console.');
    });
  </script>
</body>
</html>